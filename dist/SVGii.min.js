!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).SVGii={})}(this,(function(e){"use strict";function a(e,t=!0){t="log";const a={77:2,109:2,65:7,97:7,67:6,99:6,72:1,104:1,76:2,108:2,81:4,113:4,83:4,115:4,84:2,116:2,86:1,118:1,90:0,122:0},l=new Set([77,109,65,97,67,99,72,104,76,108,81,113,83,115,84,116,86,118,90,122]),n=new Set([5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279]);let s,h=0,r=e.length,i="",u=[],y=-1,o="",x=!1,c=!1,p=0,f=0,g=0,v=!1,M=!1,m=!1,d=!1,b=!1,C=new Set(["m","c","q","l","a","t","s","v","h"]),A=new Set(["t","s","v","h","T","S","V","H"]),P=new Set(["t","q","T","Q"]),w=[];function D(){v&&("M"===i?i="L":"m"===i&&(i="l"),u.push({type:i,values:[]}),y++,f=0,v=!1)}function T(e=!1){(e?p>0:""!==o)&&(t&&-1===y&&(s="Pathdata must start with M command",w.push(s),i="M",u.push({type:i,values:[]}),g=2,f=0,y++),"A"===i||"a"===i?(o=function(){let e=o.length,t=!1;3===f&&2===e||4===f&&e>1?(o=[+o[0],+o[1]],t=!0,f++):3===f&&e>=3&&(o=[+o[0],+o[1],+o.substring(2)],t=!0,f+=2);return t?o:[+o]}(),u[y].values.push(...o)):(t&&o[1]&&"."!==o[1]&&"0"===o[0]&&(s="Leading zeros not valid: "+o,w.push(s)),u[y].values.push(+o)),f++,o="",p=0,v=f>=g)}function L(){if(t){let e=y>0?u[y]:0,t=e?e.values.length:0;if(t&&t<g||t&&t>g||("z"===i||"Z"===i)&&t>0){s=`Pathdata commands in "${i}" (segment index: ${y}) don't match allowed number of values: ${g-t}/${g}`,w.push(s)}}}for(;h<r;){let t=e[h],s=e.charCodeAt(h);if(S=s,l.has(S)){""!==o&&(u[y].values.push(+o),f++,o=""),L(),i=t,g=a[s];let e="M"===i||"m"===i;y>0&&("z"===u[y].type||"Z"===u[y].type)&&!e&&(u.push({type:"m",values:[0,0]}),y++),u.push({type:i,values:[]}),y++,M||(M=C.has(i)),d||(d=A.has(i)),b||(b=P.has(i)),m||(m="a"===i||"A"===i),c=!1,p=0,f=0,v=!1,h++}else if(10===(I=s)||13===I||8232===I||8233===I||44===I||32===I||9===I||11===I||12===I||160===I||I>=5760&&n.has(I)>=0)T(),c=!0,x=!1,h++;else{if(h===r-1){o+=t,T(),c=!1,x=!1,L();break}if(!x&&!c&&45===s||!x&&46===s){let e=46===s;T(e),D(),e&&p++}else D();o+=t,x=69===s||101===s,c=!1,h++}}var I,S;return L(),t&&w.length&&(s="Invalid path data:\n"+w.join("\n"),console.log(s)),u[0].type="M",{pathData:u,hasRelatives:M,hasShorthands:d,hasQuadratics:b,hasArcs:m}}function l(e,t=1){let a=t>1,l=!a;"l"===e[1].type&&l&&(e[0].type="m");let n="";n=a?`${e[0].type} ${e[0].values.join(" ")}\n`:`${e[0].type}${e[0].values.join(" ")}`;for(let t=1,s=e.length;t<s;t++){let s=e[t-1],h=e[t],{type:r,values:i}=h;if(!l||"A"!==r&&"a"!==r||(i=[i[0],i[1],i[2],`${i[3]}${i[4]}${i[5]}`,i[6]]),r=s.type===h.type&&"m"!==h.type.toLowerCase()&&l||("m"===s.type&&"l"===h.type||"M"===s.type&&"l"===h.type||"M"===s.type&&"L"===h.type)&&l?" ":h.type,l){let e="",t=!1;for(let a=0,l=i.length;a<l;a++){let l=i[a],n=l.toString(),s=n.includes(".")&&Math.abs(l)<1;s&&t&&(n=n.replace(/^0\./,".")),!(a>0)||t&&s||(e+=" "),e+=n,t=s}n+=`${r}${e}`}else n+=a?`${r} ${i.join(" ")}\n`:`${r}${i.join(" ")}`}return l&&(n=n.replace(/ 0\./g," .").replace(/ -/g,"-").replace(/-0\./g,"-.").replace(/Z/g,"z")),n}function n(e){let t={x:e[0].values[0],y:e[0].values[1]},a={...t};e[0].decimals=0;let l=0,n=0;for(let s=1,h=e.length;s<h;s++){let h=e[s],{type:r,values:i}=h,u=i.length?i.slice(-2):[t.x,t.y],y=u[0],o=u[1];"Z"!==r&&"z"!==r||(y=t.x,o=t.y);let x=(Math.abs(a.x-y)+Math.abs(a.y-o))/2||0,c="Z"!==r&&"z"!==r?Math.ceil(1/x).toString().length+1:0;0===x?c=l:c&&x<.5&&c++,a={x:y,y:o},"M"===r?(t={x:i[0],y:i[1]},h.decimals=c):h.decimals=c,n=c>n?c:n,l=c}return e[0].decimals=n,e}function s(e,t=-1){let a=!("auto"!=t||!e[0].hasOwnProperty("decimals"));for(let l=0,n=e.length;l<n;l++){let n=e[l];(t>-1||a)&&(t=a?n.decimals:t,e[l].values=n.values.map((e=>e?+e.toFixed(t):e)))}return e}const{abs:h,acos:r,asin:i,atan:u,atan2:y,ceil:o,cos:c,exp:p,floor:f,log:g,max:v,min:M,pow:d,random:C,round:A,sin:w,sqrt:D,tan:T,PI:L}=Math;function I(e,t,a=!1){let l=y(t.y-e.y,t.x-e.x);return a&&l<0&&(l+=2*Math.PI),l}function S(e,t,a,l,n=!0){let s,h,r,i,u,y={};try{if(s=(l.y-a.y)*(t.x-e.x)-(l.x-a.x)*(t.y-e.y),0==s)return!1}catch{console.log("!catch",e,t,"p3:",a,l)}h=e.y-a.y,r=e.x-a.x,i=(l.x-a.x)*h-(l.y-a.y)*r,u=(t.x-e.x)*h-(t.y-e.y)*r,h=i/s,r=u/s,y={x:e.x+h*(t.x-e.x),y:e.y+h*(t.y-e.y)};let o=!1;return h>0&&h<1&&r>0&&r<1&&(o=!0),!(n&&!o)&&y}function z(e,t){return D((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function Q(e,t){return(t.x-e.x)**2+(t.y-e.y)**2}function k(e,t,a,l=!1){let n={x:(t.x-e.x)*a+e.x,y:(t.y-e.y)*a+e.y};return l&&(n.angle=I(e,t),n.angle<0&&(n.angle+=2*L)),n}function E(e,t=.5,a=!1,l=!1){let n;return n=e.length>2?((e,t,a=!1)=>{let n=4===e.length,s=e[0],h=e[1],r=n?e[2]:e[1],i=e[e.length-1],u={x:0,y:0};if(a||l){let e,a,y,o,x,c=s.x===h.x&&s.y===h.y,p=i.x===r.x&&i.y===r.y;0!==t||c?1!==t||p?(c&&(t+=1e-7),p&&(t-=1e-7),e=k(s,h,t),n?(a=k(h,r,t),y=k(r,i,t),o=k(e,a,t),x=k(a,y,t),u=k(o,x,t),u.angle=I(o,x),l&&(u.cpts=[a,y,o,x])):(a=k(s,h,t),y=k(h,i,t),u=k(a,y,t),u.angle=I(a,y),l&&(u.cpts=[a,y]))):(u.x=i.x,u.y=i.y,u.angle=I(r,i)):(u.x=s.x,u.y=s.y,u.angle=I(s,h))}else{let e=1-t;u=n?{x:e**3*s.x+3*e**2*t*h.x+3*e*t**2*r.x+t**3*i.x,y:e**3*s.y+3*e**2*t*h.y+3*e*t**2*r.y+t**3*i.y}:{x:e*e*s.x+2*e*t*h.x+t**2*i.x,y:e*e*s.y+2*e*t*h.y+t**2*i.y}}return u})(e,t,a):k(e[0],e[1],t,a),a&&n.angle<0&&(n.angle+=2*L),n}function F(e){let t=[],a={x:e[0].values[0],y:e[0].values[1]};return e.forEach((e=>{let{type:l,values:n}=e;if(n.length){let e=n.length>1?{x:n[n.length-2],y:n[n.length-1]}:"V"===l?{x:a.x,y:n[0]}:{x:n[0],y:a.y};t.push(e),a=e}})),t}function $(e,t,a,l,n,s,r,i,u){const o=(e,t,a,l)=>y(l-t,a-e);let x={cx:0,cy:0,rx:a=h(a),ry:l=h(l),startAngle:0,endAngle:0,deltaAngle:0,clockwise:r,xAxisRotation:n,largeArc:s,sweep:r};if(0==a||0==l)throw Error("rx and ry can not be 0");if(a===l){let a=Math.abs(i-e),l=Math.abs(u-t),n=a,s=Math.min(e,i),h=Math.min(t,u),y=.5*Math.PI;if(0===a&&l||0===l&&a)return n=0===a&&l?l/2:a/2,x.rx=n,x.ry=n,0===a&&l?(x.cx=e,x.cy=h+l/2,x.startAngle=t>u?y:-y,x.endAngle=t>u?-y:y,x.deltaAngle=r?Math.PI:-Math.PI):0===l&&a&&(x.cx=s+a/2,x.cy=t,x.startAngle=e>i?Math.PI:0,x.endAngle=e>i?-Math.PI:Math.PI,x.deltaAngle=r?Math.PI:-Math.PI),x}let p,f,g=a===l?0:n*L/180,v=g?w(g):0,M=g?c(g):1,m=(e-i)/2,d=(t-u)/2,b=(e+i)/2,C=(t+u)/2,A=g?M*m+v*d:m,P=g?M*d-v*m:d,T=A*A/(a*a)+P*P/(l*l);T>1&&(a*=D(T),l*=D(T),x.rx=a,x.ry=l);let I=a*l,S=a*P,z=l*A,Q=S**2+z**2;if(!Q)throw Error("start point can not be same as end point");let k=D(h((I*I-Q)/Q));s==r&&(k=-k);let E=k*S/l,F=-k*z/a;p=g?M*E-v*F+b:b+E,f=g?v*E+M*F+C:C+F,x.cy=f,x.cx=p;let $=o(p,f,e,t),B=o(p,f,i,u);!r&&B>$&&(B-=2*Math.PI),r&&$>B&&(B=B<=0?B+2*Math.PI:B);let q=B-$;return x.startAngle=$,x.endAngle=B,x.deltaAngle=q,x}function B(e,t,a,l,n,s=0,h=!0,r=!1){if(n=r?n*L/180:n,s=r?s*L/180:s,s=a!==l&&s!==2*L?s:0,h&&a!==l){let e=u(T(n=s?n-s:n)*(a/l));n=c(n)<0?e+L:e}let i=e+a*c(n),y=t+l*w(n),o={x:i,y:y};return s&&(o.x=e+(i-e)*c(s)-(y-t)*w(s),o.y=t+(i-e)*w(s)+(y-t)*c(s)),o}function q(e,t=[],a=.05){let l=3===t.length,n=t[0],s=l?t[1]:null,h=l?t[2]:t[1],r=.5*Math.PI,i=!1,u=!1,y=I(h,n,!0);if(i=Math.abs(y%r)<a||Math.abs(y%r-r)<a,l){let e=s?I(s,h,!0):0;u=Math.abs(e%r)<=a||Math.abs(e%r-r)<=a}return i||u}function O(e){return 4===e.length?j(e[0],e[1],e[2],e[3]):R(e[0],e[1],e[2])}function N(e,t){const a=(e,t,a,l,n,s)=>{var h=Math.cos(s),r=Math.sin(s),i=l*Math.cos(e),u=n*Math.sin(e);return{x:t+h*i-r*u,y:a+r*i+h*u}};let l,n,s,h,r,i=$(e.x,e.y,t[0],t[1],t[2],t[3],t[4],t[5],t[6]),{rx:u,ry:y,cx:o,cy:x,endAngle:c,deltaAngle:p}=i,f=t[2],g={x:t[5],y:t[6]},v=[g],M=f*Math.PI/180,m=Math.tan(M);r=Math.atan2(-y*m,u);let d=r,b=r+Math.PI,C=Math.atan2(y,u*m),A=C+Math.PI,P=[e.x,g.x],w=[e.y,g.y],D=Math.min(...P),T=Math.max(...P),L=Math.min(...w),I=Math.max(...w),S=a(c-.001*p,o,x,u,y,M),z=a(c-.999*p,o,x,u,y,M);return(S.x>T||z.x>T)&&(l=a(d,o,x,u,y,M),v.push(l)),(S.x<D||z.x<D)&&(n=a(b,o,x,u,y,M),v.push(n)),(S.y<L||z.y<L)&&(h=a(A,o,x,u,y,M),v.push(h)),(S.y>I||z.y>I)&&(s=a(C,o,x,u,y,M),v.push(s)),v}function j(e,t,a,l){let[n,s,h,r,i,u,y,o]=[e.x,e.y,t.x,t.y,a.x,a.y,l.x,l.y],x=Math.min(e.y,l.y),c=Math.min(e.x,l.x),p=Math.max(e.x,l.x),f=Math.max(e.y,l.y);if(t.y>=x&&t.y<=f&&a.y>=x&&a.y<=f&&t.x>=c&&t.x<=p&&a.x>=c&&a.x<=p)return[];for(var g,v,M,m,d,b,C,A,P=[],w=0;w<2;++w)if(0==w?(v=6*n-12*h+6*i,g=-3*n+9*h-9*i+3*y,M=3*h-3*n):(v=6*s-12*r+6*u,g=-3*s+9*r-9*u+3*o,M=3*r-3*s),Math.abs(g)<1e-12){if(Math.abs(v)<1e-12)continue;0<(m=-M/v)&&m<1&&P.push(m)}else(C=v*v-4*M*g)<0?Math.abs(C)<1e-12&&0<(m=-v/(2*g))&&m<1&&P.push(m):(0<(d=(-v+(A=Math.sqrt(C)))/(2*g))&&d<1&&P.push(d),0<(b=(-v-A)/(2*g))&&b<1&&P.push(b));for(var D=P.length;D--;)m=P[D];return P}function R(e,t,a){let l,n,s,h=Math.min(e.y,a.y),r=Math.min(e.x,a.x),i=Math.max(e.x,a.x),u=Math.max(e.y,a.y);if(t.y>=h&&t.y<=u&&t.x>=r&&t.x<=i)return[];let[y,o,x,c,p,f]=[e.x,e.y,t.x,t.y,a.x,a.y],g=[];for(var v=0;v<2;++v)l=0==v?y-2*x+p:o-2*c+f,n=0==v?-2*y+2*x:-2*o+2*c,Math.abs(l)>1e-12&&(s=-n/(2*l),s>0&&s<1&&g.push(s));return g}function J(e,t=.025){let a=e[0],l=e[e.length-1],n=e.map((e=>e.x)),s=e.map((e=>e.y)),h=Math.min(...n),r=Math.max(...n),i=Math.min(...s),u=r-h,y=Math.max(...s)-i;if(e.length<3||0===u||0===y)return{area:0,flat:!0,thresh:1e-4,ratio:0};let o=Q(a,l),x=Q(a,e[0]),c=(x+(e.length>3?Q(l,e[1]):x))/2;let p=.5*(u+y)*.5,f=0;for(let t=0,a=e.length;t<a;t++){f+=e[t].x*e[t===e.length-1?0:t+1].y*.5-e[t===e.length-1?0:t+1].x*e[t].y*.5}f=+Math.abs(f).toFixed(9);return{area:f,flat:0===f||f<c/1e3,thresh:p,ratio:f/c,squareDist:o,areaThresh:o/1e3}}function V(e,t="",a="green",l="1%",n=!0){let s=`<path d="${t}" fill="none" stroke="${a}"  stroke-width="${l}" /> `;if(!n)return s;e.insertAdjacentHTML("beforeend",s)}function Z(e=[],t=!1){for(let a=0,l=e.length;a<l;a++){let l=e[a].pathData;e[a].chunks=[[l[0]],[]];let n=[[l[0]],[]],s=1,h=!1,r=!1,i=!1,u="M",y=!1;for(let e=1,t=l.length;e<t;e++){let t=l[e],{extreme:a,corner:o,directionChange:x}=t;y=u!==t.type,(x||h||r||i||y)&&n[s].length&&(n.push([]),s++),h=a,r=o,i="z"===t.type.toLowerCase(),u=t.type,n[s].push(t)}t&&n.forEach(((e,t)=>{let a=t%2==0?"green":"orange";t===n.length-2&&(a="magenta");let l=e[0].p0;if(l){let t=`M ${l.x} ${l.y}`;e.forEach((e=>{t+=`${e.type} ${e.values.join(" ")}`})),V(svg1,t,a,"0.5%","0.5")}})),e[a].chunks=n}return e}function H(e){let t=[];try{e.map(((e,t)=>"m"===e.type.toLowerCase()?t:-1)).filter((e=>-1!==e))}catch{console.log("catch",e)}let a=e.map(((e,t)=>"m"===e.type.toLowerCase()?t:-1)).filter((e=>-1!==e));return 1===a.length?[e]:(a.forEach(((l,n)=>{t.push(e.slice(l,a[n+1]))})),t)}function U(e,t){let a,l,n,s,h,r,i=[],u=[],y=e[0],o=e[1],x=e[e.length-2],c=e[e.length-1];return 4===e.length?(a=E([y,o],t),l=E([o,x],t),n=E([x,c],t),s=E([a,l],t),h=E([l,n],t),r=E([s,h],t),i.push({x:y.x,y:y.y},{x:a.x,y:a.y},{x:s.x,y:s.y},{x:r.x,y:r.y}),u.push({x:r.x,y:r.y},{x:h.x,y:h.y},{x:n.x,y:n.y},{x:c.x,y:c.y})):3===e.length?(l=E([y,o],t),n=E([o,c],t),r=E([l,n],t),i.push({x:y.x,y:y.y},{x:l.x,y:l.y},{x:r.x,y:r.y}),u.push({x:r.x,y:r.y},{x:n.x,y:n.y},{x:c.x,y:c.y})):2===e.length&&(l=E([y,c],t),i.push({x:y.x,y:y.y},{x:l.x,y:l.y}),u.push({x:l.x,y:l.y},{x:c.x,y:c.y})),[i,u]}function G(e,t){let a=[],l=6===t.length?"C":"Q",n={x:t[0],y:t[1]},s="C"===l?{x:t[2],y:t[3]}:n,h={x:t[4],y:t[5]},r=Math.max(h.x,e.x),i=Math.min(h.x,e.x),u=Math.max(h.y,e.y),y=Math.min(h.y,e.y),o=0;if(n.x<i||n.x>r||n.y<y||n.y>u||s.x<i||s.x>r||s.y<y||s.y>u){let r=O("C"===l?[e,n,s,h]:[e,n,h]).sort();if(r.length){let l=_(e,t,r);a.push(...l),o+=l.length}else console.log("no extreme: ",r),a.push({type:l,values:t})}else a.push({type:l,values:t});return{pathData:a,count:o}}function _(e,t,a,l=!0){let n=[];if(!a.length)return!1;let s,h,r,i=t.length,u={x:t[i-2],y:t[i-1]};if(2===t.length?r=[e,u]:4===t.length?(s={x:t[0],y:t[1]},r=[e,s,u]):6===t.length&&(s={x:t[0],y:t[1]},h={x:t[2],y:t[3]},r=[e,s,h,u]),a.length)if(1===a.length){let e=U(r,a[0]),t=e[0],l=e[1];n.push(t,l)}else{let e=a[0],t=U(r,e),l=t[0];n.push(l),r=t[1];for(let t=1;t<a.length;t++){e=a[t-1];let l=U(r,(a[t]-e)/(1-e));n.push(l[0]),t===a.length-1&&n.push(l[l.length-1]),r=l[1]}}if(l){let e,t,a=[];return n.forEach((l=>{e={type:"",values:[]},l.shift(),t=l.map((e=>Object.values(e))).flat(),e.values=t,3===l.length?e.type="C":2===l.length?e.type="Q":1===l.length&&(e.type="L"),a.push(e)})),a}return n}function K(e,t=-1){let a=e.map((e=>e.x)),l=e.map((e=>e.y)),n=Math.min(...a),s=Math.max(...a),h=Math.min(...l),r=Math.max(...l),i={x:n,left:n,right:s,y:h,top:h,bottom:r,width:s-n,height:r-h};if(t>-1)for(let e in i)i[e]=+i[e].toFixed(t);return i}function W(e){let t=[];return e.forEach((e=>{let a=Y(e);t.push(a)})),t}function X(e,t){let[a,l,n,s,h,r]=[e.x,e.y,e.width,e.height,e.x+e.width,e.y+e.height],[i,u,y,o,x,c]=[t.x,t.y,t.width,t.height,t.x+t.width,t.y+t.height],p=!1;return n*s!=y*o&&n*s>y*o&&a<i&&h>x&&l<u&&r>c&&(p=!0),p}function Y(e){return K(ee(e))}function ee(e){let t=[];for(let a=0;a<e.length;a++){let l=e[a],n=a>0?e[a-1]:e[a],{type:s,values:h}=l,r={x:n.values[n.values.length-2],y:n.values[n.values.length-1]},i=h.length?{x:h[h.length-2],y:h[h.length-1]}:"",u=h.length?{x:h[0],y:h[1]}:"";switch(s){case"A":if("function"!=typeof arcToBezier){let e=z(r,i)/2,a=k(r,i,.5),l=B(a.x,a.y,e,e,0),n=B(a.x,a.y,e,e,Math.PI);t.push(l,n,i);break}arcToBezier(r,h).forEach((e=>{let a=e.values,l={x:a[0],y:a[1]},n={x:a[2],y:a[3]},s={x:a[4],y:a[5]};t.push(l,n,s)}));break;case"C":let e={x:h[2],y:h[3]};t.push(u,e);break;case"Q":t.push(u)}"z"!==s.toLowerCase()&&t.push(i)}return t}function te(e){let t=1/0,a=-1/0,l=1/0,n=-1/0;const s=e=>{e.x<t&&(t=e.x),e.x>a&&(a=e.x),e.y<l&&(l=e.y),e.y>n&&(n=e.y)};for(let t=0;t<e.length;t++){let a=e[t],{type:l,values:n}=a,h=n.length,r=(e[t-1]?e[t-1]:e[t]).values,i=r.length;if(h){let e={x:r[i-2],y:r[i-1]},t={x:n[h-2],y:n[h-1]};if(s(t),"C"===l||"Q"===l){let a={x:n[0],y:n[1]},h="C"===l?{x:n[2],y:n[3]}:a,r="C"===l?[e,a,h,t]:[e,a,t];O(r).forEach((e=>{let t=E(r,e);s(t)}))}else if("A"===l){N(e,n).forEach((e=>{s(e)}))}}}return{x:t,y:l,width:a-t,height:n-l}}function ae(e,t){let a=0,l="z"===e[e.length-1].type.toLowerCase();if(!l||t<1||e.length<3)return e;let n=l?1:0;le(e),a=t+1<e.length-1?t+1:e.length-1-n;let s,h,r=e.slice(a),i=e.slice(0,a);return i.shift(),s=i[i.length-1].values||[],h=[s[s.length-2],s[s.length-1]],n&&(r.pop(),i.push({type:"Z",values:[]})),e=[{type:"M",values:h},...r,...i]}function le(e){let t=e.length,a="Z"==e[t-1].type,l=e[0],[n,s]=[l.values[0],l.values[1]].map((e=>+e.toFixed(8))),h=a?e[t-2]:e[t-1],r=h.values.length,[i,u]=[h.values[r-2],h.values[r-1]].map((e=>+e.toFixed(8)));return!a||n==i&&s==u||(e.pop(),e.push({type:"L",values:[n,s]},{type:"Z",values:[]})),e}function ne(e,t=!1,a=!0,l=!0,n=!1){let s=[],h=[(e=JSON.parse(JSON.stringify(e)))[0]],r=K(F(e)),{width:i,height:u}=r,y=(i+u)/2*.001,o={x:e[0].values[0],y:e[0].values[1]},x={x:e[0].values[0],y:e[0].values[1]},c=!1;for(let l=1,r=e.length;r&&l<r;l++){let r=e[l],i=e[l+1]?e[l+1]:"",{type:u,values:p}=r,f=p.slice(-2),g={x:f[0],y:f[1]},v=[o,g];"C"!==u&&"Q"!==u||v.push({x:p[0],y:p[1]}),"C"===u&&v.push({x:p[2],y:p[3]});let M=v.map((e=>e.x)),m=v.map((e=>e.y)),d=(Math.max(...M)-Math.min(...M)+(Math.max(...m)-Math.min(...m)))/2||0;if("z"!==u.toLowerCase()){if(g.x===o.x&&g.y===o.y||"L"===u&&d<y){n&&s.push(`removed zero length ${u}`);continue}if("L"===u){if(a&&g.x===x.x&&g.y===x.y&&"z"===i.type.toLowerCase()){n&&s.push("unnessecary closing linto");continue}if("L"===i.type){let e=i.values.slice(-2);if(J([o,g,{x:e[0],y:e[1]}],y).flat){n&&s.push("remove flat linetos");continue}}}if("C"===u){let e=J([o,{x:p[0],y:p[1]},{x:p[2],y:p[3]},g],y),a=e.flat,l=e.ratio,h=i?i.values.slice(-2):"",u=h.length?{x:h[0],y:h[1]}:"";if(a){let e,t=!1;"C"===i.type&&(e=J([o,g,u],y),t=e.flat,t&&n&&s.push(`skip cubic - actually a lineto:  area-ratio: ${l}, flatness next:${e}`)),l<.1&&s.push("simplify cubic to lineto")}else t&&(c=G(o,p),r=c.pathData),t&&c.count&&s.push(`added extremes: ${c.count}`)}}r.length?h.push(...r):h.push(r),"z"===u.toLowerCase()?o=x:"M"===u&&(x={x:f[0],y:f[1]}),o={x:f[0],y:f[1]}}return h=se(h,a,l),s.push(`original command count: ${e.length}; removed:${e.length-h.length} `),n&&console.log(s),h}function se(e,t=!1,a=!1){let l=H(e),n=[],s=l.length;for(let e=0;e<s;e++){let s=l[e],h=s.findIndex((e=>"L"===e.type)),r=s.findIndex((e=>"C"===e.type||"Q"===e.type)),i=new Set([...s.map((e=>e.type))]),u=i.has("L"),y=i.has("C")||i.has("Q"),o=s.length,x="z"===s[o-1].type.toLowerCase();if(x){if(x){let e=-1,l=0;if(a){let e=[];for(let t=0,a=s.length;t<a;t++){let a=s[t],{type:l,values:n}=a;if(n.length){let a=n.slice(-2),l={x:a[0],y:a[1],index:t};e.push(l)}}e=e.sort(((e,t)=>{e.y,t.y})),l=e[0].index}else{let t=K(F(s)),{left:a,right:n,top:i,bottom:o,width:x,height:c}=t,p=1/0,f=1/0;if(y)for(let t=0,l=s.length;t<l;t++){let l=s[t],{type:h,values:r}=l;if("C"===h||"Q"===h){let l=r.slice(-2),s={x:l[0],y:l[1]};s.x!==a&&s.y!==i&&s.x!==n&&s.y!==o||s.x<p&&s.y<f&&(e=t,p=s.x,f=s.y)}}r=e>-1?e:r,l=u?h:r}s=ae(s,l),o=s.length;let i={x:s[0].values[0],y:s[0].values[1]},x=s[o-2],c=x.type,p=x.values.slice(-2),f="L"===c&&p[0]===i.x&&p[1]===i.y;t&&f&&s.splice(o-2,1),n.push(...s)}}else n.push(...s)}return n}function he(e,t=9){let a=0,l=[],n=H(e),s=n.length>1,h=[];if(s){let e=W(n);e.forEach((function(t,a){for(let a=0;a<e.length;a++){let l=e[a];if(t!=l){X(t,l)&&h.push(a)}}}))}return n.forEach(((e,t)=>{l=[];let n=0,s=0,r=1,i=[];e.forEach((function(t,a){let[s,h]=[t.type,t.values],r=h.length;if(h.length){let u=(a>0?e[a-1]:e[0]).values,y=u.length,o={x:u[y-2],y:u[y-1]},x={x:h[r-2],y:h[r-1]};if("C"===s||"Q"===s){let e={x:h[0],y:h[1]};i="C"===s?[o,e,{x:h[2],y:h[3]},x]:[o,e,x];let t=Math.abs(ye(i));n+=t,l.push(o,x)}else if("A"===s){let e=$(o.x,o.y,t.values[0],t.values[1],t.values[2],t.values[3],t.values[4],x.x,x.y),{cx:a,cy:s,rx:h,ry:r,startAngle:i,endAngle:u,deltaAngle:y}=e,c=Math.abs(ie(h,r,i,u));c-=Math.abs(oe([o,{x:a,y:s},x])),l.push(o,x),n+=c}else l.push(o,x)}}));let u=oe(l);-1!==h.indexOf(t)&&(r=-1),s=u<0&&n<0?(Math.abs(n)-Math.abs(u))*r:(Math.abs(n)+Math.abs(u))*r,a+=s})),a}function re(e=[],t=0,a=0,l=.75){let n=4===e.length?"C":"Q",s=e.shift(),h=e[0],r=e[e.length-1],i="C"===n?e[1]:h,u={accurate:!1,areaDiff:1/0,comArea:null,cpArea:null,signChange:null},y=S(s,r,h,i,!0),o=S(s,h,r,i,!0);if(y||o)return u;if(u.cpArea=oe([s,...e]),u.signChange=u.cpArea<0&&a>0||u.cpArea>0&&a<0,u.signChange)return u;let x=[{type:"M",values:[s.x,s.y]},{type:n,values:[...e.map((e=>[e.x,e.y])).flat()]}];return u.comArea=he(x),u.areaDiff=ue(t,u.comArea),u.accurate=u.areaDiff<.3*l,u}function ie(e,t,a,l){const n=Math.PI*e*t;let s=(l-a+2*Math.PI)%(2*Math.PI);if(e===t)return n*(s/(2*Math.PI));const h=a=>Math.atan2(e*Math.sin(a),t*Math.cos(a));return a=h(a),s=((l=h(l))-a+2*Math.PI)%(2*Math.PI),n*(s/(2*Math.PI))}function ue(e,t){let a=Math.abs(e-t);return Math.abs(100-100/e*(e+a))}function ye(e){let t,[a,l,n,s]=[e[0],e[1],e[2],e[e.length-1]];return e.length<3?0:(3===e.length&&(l={x:1*e[0].x/3+2*e[1].x/3,y:1*e[0].y/3+2*e[1].y/3},n={x:1*e[2].x/3+2*e[1].x/3,y:1*e[2].y/3+2*e[1].y/3}),t=3*(a.x*(-2*l.y-n.y+3*s.y)+l.x*(2*a.y-n.y-s.y)+n.x*(a.y+l.y-2*s.y)+s.x*(-3*a.y+l.y+2*n.y))/20,t)}function oe(e,t=.001){let a=0;for(let t=0,l=e.length;l&&t<l;t++){a+=e[t].x*e[t===e.length-1?0:t+1].y*.5-e[t===e.length-1?0:t+1].x*e[t].y*.5}return a}function xe(e,t=7.5){let a=[],l=H(e);for(let e=0,n=l.length;e<n;e++){let n,s,h,r=l[e],i=[],u={x:r[0].values[0],y:r[0].values[1]},y=u;for(let e=0,a=r.length;e<a;e++){let a=r[e],{type:l,values:o}=a,x=o.slice(-2);if(h={x:x[0],y:x[1]},"M"===l&&(u={x:o[0],y:o[1]},y=u),"z"===l.toLowerCase()&&(y=u),"C"===l){n={x:o[0],y:o[1]},s={x:o[2],y:o[3]},y.x,y.y,n.x,n.y,s.x,s.y,h.x,h.y;let e=ce(y,n,s,h,t),{isArc:l,area:r}=e;l&&(a=e.com),i.push(a),y=h}else y=h,i.push(a)}a.push(...i)}return a}function ce(e,t,a,l,n=7.5){let s={type:"C",values:[t.x,t.y,a.x,a.y,l.x,l.y]},h=0,r=!1,i=I(e,t,!0),u=I(l,a,!0),y=180*Math.abs(i-u)/Math.PI;if(Math.abs(y%180-90)<3){let i=S(e,t,l,a,!1);if(i){let u=z(e,i),y=z(l,i),o=+Math.max(u,y).toFixed(8),x=+Math.min(u,y).toFixed(8),c=x,p=o,f=oe([e,t,a,l])<0?0:1,g=Math.abs(l.x-e.x)>Math.abs(l.y-e.y);100/c*Math.abs(c-p)<5&&(c=o,p=c),g&&(c=o,p=x);let v=he([{type:"M",values:[e.x,e.y]},{type:"C",values:[t.x,t.y,a.x,a.y,l.x,l.y]}]),M={type:"A",values:[c,p,0,0,f,l.x,l.y]};h=Math.PI*(c*p)/4,h-=Math.abs(oe([e,l,i])),ue(v,h)<n&&(r=!0,s=M)}}return{com:s,isArc:r,area:h}}function pe(e){let t,a=[[]],l=0,n=[[]],s={x:e[0].values[0],y:e[0].values[1]};for(let h=0,r=e.length;h<r;h++){let r=e[h],{type:i,values:u}=r;if("A"===i){let i=e[h-1].values.slice(-2);s={x:i[0],y:i[1]};let[y,o,x,c,p,f,g]=u,v=100/y*Math.abs(y-o)<5;t={x:u[5],y:u[6]},r.p0=s,r.p=t,r.circular=v;let M=e[h+1];if(!a[l].length&&M&&"A"===M.type&&(a[l].push(r),n[l].push(h)),M&&"A"===M.type){let[e,r,i,u,x,c,p]=M.values,f=y!=e?100/y*Math.abs(y-e):0,g=o!=r?100/o*Math.abs(o-r):0;t={x:M.values[5],y:M.values[6]},M.p0=s,M.p=t,f<5&&g<5?(a[l].push(M),n[l].push(h+1)):(a.push([]),n.push([]),l++)}else a.push([]),n.push([]),l++}}if(!n.length)return e;a=a.filter((e=>e.length)),n=n.filter((e=>e.length));for(let t=a.length-1;t>=0;t--){const l=a[t],s=n[t][0],h=l.length;let r=0,i=0;l.forEach((({values:e})=>{const[t,a]=e;r+=t,i+=a})),r/=h,i/=h;let u=100/r*Math.abs(r-i)<5;u&&(r=(r+i)/2,i=r);let y=e[s-1].values.slice(-2);if(y[0],y[1],4===h){let[t,a,n,y,o,x,c]=l[1].values,[,,,,,p,f]=l[3].values;u&&(r=1,i=1);let g={type:"A",values:[r,i,n,y,o,x,c]},v={type:"A",values:[r,i,n,y,o,p,f]};e.splice(s,h,g,v)}else if(3===h){let[t,a,n,u,y,o,x]=l[0].values,[c,p,,,,f,g]=l[2].values;u=1;let v={type:"A",values:[r,i,n,u,y,f,g]};e.splice(s,h,v)}else if(2===h){let[t,a,n,y,o,x,c]=l[0].values,[p,f,,,,g,v]=l[1].values;u&&(r=1,i=1,n=0);let{p0:M,p:m}=l[0],[d,b]=[l[1].p0,l[1].p];if(M.x!==b.x||M.y!==b.y){let t={type:"A",values:[r,i,n,y,o,g,v]};e.splice(s,h,t)}}}return e}function fe(e,{arcAccuracy:t=1}={}){let a=[e[0]];for(let l=1,n=e.length;l<n;l++){let n=e[l],s=e[l-1].values,h=s.length,r={x:s[h-2],y:s[h-1]};if("A"===n.type){we(r,n.values,t).forEach((e=>{a.push(e)}))}else a.push(n)}return a}function ge(e){let t=[e[0]];for(let a=1,l=e.length;a<l;a++){let l=e[a],n=e[a-1].values,s=n.length,h={x:n[s-2],y:n[s-1]};"Q"===l.type?t.push(ve(h,l.values)):t.push(l)}return t}function ve(e,t){Array.isArray(e)&&(e={x:e[0],y:e[1]});let a={x:e.x+2/3*(t[0]-e.x),y:e.y+2/3*(t[1]-e.y)},l={x:t[2]+2/3*(t[0]-t[2]),y:t[3]+2/3*(t[1]-t[3])};return{type:"C",values:[a.x,a.y,l.x,l.y,t[2],t[3]]}}function Me(e,t=!1,a=-1){a>=0&&(e[0].values=e[0].values.map((e=>+e.toFixed(a))));let l=e[0].values,n=l[0],s=l[1],h=n,r=s;for(let l=1,i=e.length;l<i;l++){let i=e[l],{type:u,values:y}=i,o=t?u.toLowerCase():u.toUpperCase();if(u!==o)switch(u=o,i.type=u,u){case"a":case"A":y[5]=t?y[5]-n:y[5]+n,y[6]=t?y[6]-s:y[6]+s;break;case"v":case"V":y[0]=t?y[0]-s:y[0]+s;break;case"h":case"H":y[0]=t?y[0]-n:y[0]+n;break;case"m":case"M":t?(y[0]-=n,y[1]-=s):(y[0]+=n,y[1]+=s),h=t?y[0]+n:y[0],r=t?y[1]+s:y[1];break;default:if(y.length)for(let e=0;e<y.length;e++)y[e]=t?y[e]-(e%2?s:n):y[e]+(e%2?s:n)}let x=y.length;switch(u){case"z":case"Z":n=h,s=r;break;case"h":case"H":n=t?n+y[0]:y[0];break;case"v":case"V":s=t?s+y[0]:y[0];break;case"m":case"M":h=y[x-2]+(t?n:0),r=y[x-1]+(t?s:0);default:n=y[x-2]+(t?n:0),s=y[x-1]+(t?s:0)}a>=0&&(i.values=i.values.map((e=>+e.toFixed(a))))}return e}function me(e,t=-1){return Me(e,!0,t)}function de(e,t=-1){return Me(e,!1,t)}function be(e,t=-1,a=!0){let l;if(a){let t=e.map((e=>e.type)).join(""),a=/[hstv]/gi.test(t);if(l=/[astvqmhlc]/g.test(t),!a)return e}let n=[],s={type:"M",values:(e=a&&l?de(e,t):e)[0].values};n.push(s);for(let a=1,l=e.length;a<l;a++){let l,h,r,i,u,y,o,x,c=e[a],{type:p,values:f}=c,g=f.length,v=s.values,M=v.length,[m,d]=[f[g-2],f[g-1]],[b,C]=[v[M-2],v[M-1]];switch(p){case"H":s={type:"L",values:[f[0],C]};break;case"V":s={type:"L",values:[b,f[0]]};break;case"T":[l,h]=[v[0],v[1]],[b,C]=[v[M-2],v[M-1]],r=b+(b-l),i=C+(C-h),s={type:"Q",values:[r,i,m,d]};break;case"S":[l,h]=[v[0],v[1]],[b,C]=[v[M-2],v[M-1]],[o,x]=M>2&&"A"!==s.type?[v[2],v[3]]:[b,C],r=2*b-o,i=2*C-x,u=f[0],y=f[1],s={type:"C",values:[r,i,u,y,m,d]};break;default:s={type:p,values:f}}t>-1&&(s.values=s.values.map((e=>+e.toFixed(t)))),n.push(s)}return n}function Ce(e,t=-1,a=!0){let l;if(a){let t=e.map((e=>e.type)).join("");l=/[astvqmhlc]/g.test(t)}let n={type:"M",values:(e=a&&l?de(e,t):e)[0].values};e[0].decimals&&(n.decimals=e[0].decimals);let s,h=[n],r={x:e[0].values[0],y:e[0].values[1]};for(let a=1,l=e.length;a<l;a++){let l=e[a],{type:i,values:u}=l,y=u.slice(-2),o=e[a-1],x=o.type;s={x:y[0],y:y[1]};let c,p,f,g,v={x:u[0],y:u[1]},M=Math.abs(s.x-r.x),m=Math.abs(s.y-r.y),d=(M+m)/2*.01;switch(i){case"L":n=0===m||m<d&&M>d?{type:"H",values:[u[0]]}:0===M||m>d&&M<d?{type:"V",values:[u[1]]}:l;break;case"Q":if("Q"!==x){r={x:y[0],y:y[1]},h.push(l);continue}let e={x:o.values[0],y:o.values[1]};g={x:2*r.x-e.x,y:2*r.y-e.y},c=Math.abs(v.x-g.x),p=Math.abs(v.y-g.y),f=(c+p)/2,n=f<d?{type:"T",values:[s.x,s.y]}:l;break;case"C":let t={x:u[2],y:u[3]};if("C"!==x){h.push(l),r={x:y[0],y:y[1]};continue}let a={x:o.values[2],y:o.values[3]};g={x:2*r.x-a.x,y:2*r.y-a.y},c=Math.abs(v.x-g.x),p=Math.abs(v.y-g.y),f=(c+p)/2,n=f<d?{type:"S",values:[t.x,t.y,s.x,s.y]}:l;break;default:n={type:i,values:u}}(l.decimals||0===l.decimals)&&(n.decimals=l.decimals),t>-1&&(n.values=n.values.map((e=>+e.toFixed(t)))),r={x:y[0],y:y[1]},h.push(n)}return h}function Ae(e,t=.1){let a=[(e=be(e))[0]];for(let l=1,n=e.length;l<n;l++){let n=e[l-1],s=e[l],[h,r]=[s.type,s.values],[i,u]=[n.type,n.values],y=u.length,[o,x]=[u[y-2],u[y-1]];if("C"==h){Pe(o,x,r[0],r[1],r[2],r[3],r[4],r[5],t).forEach((e=>{a.push(e)}))}else a.push(s)}return a}function Pe(e,a,l,n,s,h,r,i,u){const y=(e,t,a,l,n,s,h,r,i)=>{let u=1-i,y=e*u+a*i,o=a*u+n*i,x=n*u+h*i,c=y*u+o*i,p=o*u+x*i,f=c*u+p*i,g=t*u+l*i,v=l*u+s*i,M=s*u+r*i,m=g*u+v*i,d=v*u+M*i,b=m*u+d*i;return[[e,t,y,g,c,m,f,b],[f,b,p,d,x,M,h,r]]};let o,c=((e,t,a,l,n,s,h,r)=>((e,t,a)=>{if(0===e)return 0===t?[]:[-a/t];let l=t*t-4*e*a;if(Math.abs(l)<1e-16)return[-t/(2*e)];if(l<0)return[];let n=Math.sqrt(l);return[(-t-n)/(2*e),(-t+n)/(2*e)]})(-h*(t-2*l+s)+n*(2*t-3*l+r)+e*(l-2*s+r)-a*(t-3*s+2*r),h*(t-l)+3*n*(-t+l)+a*(2*t-3*s+r)-e*(2*l-3*s+r),n*(t-l)+e*(l-s)+a*(-t+s)).filter((function(e){return e>1e-8&&e<1-1e-8})).sort(((e,t)=>e-t)))(e,a,l,n,s,h,r,i);if(c.length){for(var p,f,g=[],v=[e,a,l,n,s,h,r,i],M=0,d=0;d<c.length;d++)f=y(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],1-(1-c[d])/(1-M)),p=A(f[0][0],f[0][1],f[0][2],f[0][3],f[0][4],f[0][5],f[0][6],f[0][7],u),g=g.concat(p.slice(0,-2)),v=f[1],M=c[d];p=A(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],u),o=g.concat(p)}else o=A(e,a,l,n,s,h,r,i,u);let C=[];for(let e=2;e<o.length;e+=4)C.push({type:"Q",values:[o[e],o[e+1],o[e+2],o[e+3]]});return C;function A(e,a,l,n,s,h,r,i,u=.1){const y=(e,t,a,l,n,s)=>{for(let h=1/n.length,r=0;r<n.length;r++)if(!D(e,t,a,l,r*h,(r+1)*h,n[r][0],n[r][1],n[r][2],s))return!1;return!0},o=(e,t,a,l,n)=>({x:((e.x*n+t.x)*n+a.x)*n+l.x,y:((e.y*n+t.y)*n+a.y)*n+l.y}),C=(e,t,a,l)=>({x:(e.x*l+t.x)*l+a.x,y:(e.y*l+t.y)*l+a.y}),A=(e,t,a,l,n)=>({x:(3*e.x*n+2*t.x)*n+a.x,y:(3*e.y*n+2*t.y)*n+a.y}),w=(e,t,a,l,n,s)=>{var h=o(e,t,a,l,n),r=o(e,t,a,l,s),i=A(e,t,a,0,n),u=A(e,t,a,0,s),y=-i.x*u.y+u.x*i.y;return Math.abs(y)<1e-8?[h,{x:(h.x+r.x)/2,y:(h.y+r.y)/2},r]:[h,{x:(i.x*(r.y*u.x-r.x*u.y)+u.x*(h.x*i.y-h.y*i.x))/y,y:(i.y*(r.y*u.x-r.x*u.y)+u.y*(h.x*i.y-h.y*i.x))/y},r]},D=(e,a,l,n,s,h,r,i,u,y)=>{const x=(e,t,a)=>{let l=a.x-t.x,n=a.y-t.y,s=(e.x-t.x)*l+(e.y-t.y)*n,h=l*l+n*n,r=0;return 0!=h&&(r=s/h),r=r<=0?Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2):r>=1?Math.pow(e.x-a.x,2)+Math.pow(e.y-a.y,2):Math.pow(e.x-(t.x+l*r),2)+Math.pow(e.y-(t.y+n*r),2),r};let c,p,f,g,v,M=((e,t,a)=>[{x:-2*t.x+e.x+a.x,y:-2*t.y+e.y+a.y},{x:2*(t.x-e.x),y:2*(t.y-e.y)},e])(r,i,u),m=M[0],d=M[1],b=M[2],A=y*y,P=[],w=[];for(c=(h-s)/10,p=0,t=s;p<=10;p++,t+=c)P.push(o(e,a,l,n,t));for(c=.1,p=0,t=0;p<=10;p++,t+=c)w.push(C(m,d,b,t));for(p=1;p<P.length-1;p++){for(v=1/0,f=0;f<w.length-1;f++)g=x(P[p],w[f],w[f+1]),v=Math.min(v,g);if(v>A)return!1}for(p=1;p<w.length-1;p++){for(v=1/0,f=0;f<P.length-1;f++)g=x(w[p],P[f],P[f+1]),v=Math.min(v,g);if(v>A)return!1}return!0};for(M=((e,t,a,l)=>[{x:l.x-e.x+3*(t.x-a.x),y:l.y-e.y+3*(t.y-a.y)},{x:3*(e.x+a.x)-6*t.x,y:3*(e.y+a.y)-6*t.y},{x:3*(t.x-e.x),y:3*(t.y-e.y)},e])(p={x:e,y:a},f={x:l,y:n},g={x:s,y:h},v={x:r,y:i}),d=M[0],P=M[1],m=M[2],x=M[3],b=1;b<=8;b++){c=[];for(let e=0;e<1;e+=1/b)c.push(w(d,P,m,x,e,e+1/b));let e=(c[0][1].x-p.x)*(f.x-p.x)+(c[0][1].y-p.y)*(f.y-p.y),t=(c[0][1].x-v.x)*(g.x-v.x)+(c[0][1].y-v.y)*(g.y-v.y);if((1!==b||!(e<0||t<0))&&y(d,P,m,x,c,u))break}let T=[c[0][0].x,c[0][0].y];for(let e=0;e<c.length;e++)T.push(c[e][1].x,c[e][1].y,c[e][2].x,c[e][2].y);return T}}function we(e,t,a=1){const l=2*Math.PI;let[n,s,h,r,i,u,y]=t;if(0===n||0===s)return[];let o=h?h*l/360:0,x=o?Math.sin(o):0,c=o?Math.cos(o):1,p=c*(e.x-u)/2+x*(e.y-y)/2,f=-x*(e.x-u)/2+c*(e.y-y)/2;if(0===p&&0===f)return[];n=Math.abs(n),s=Math.abs(s);let g=p*p/(n*n)+f*f/(s*s);if(g>1){let e=Math.sqrt(g);n*=e,s*=e}let v=n*n,M=n===s?v:s*s,m=p*p,d=f*f,b=v*M-v*d-M*m;b<=0?b=0:(b/=v*d+M*m,b=Math.sqrt(b)*(r===i?-1:1));let C=b?b*n/s*f:0,A=b?b*-s/n*p:0,P=c*C-x*A+(e.x+u)/2,w=x*C+c*A+(e.y+y)/2,D=(p-C)/n,T=(f-A)/s,L=(-p-C)/n,I=(-f-A)/s;const S=(e,t,a,l)=>{let n=+(e*a+t*l).toFixed(9);return 1===n||-1===n?1===n?0:Math.PI:(n=n>1?1:n<-1?-1:n,(e*l-t*a<0?-1:1)*Math.acos(n))};let z=S(1,0,D,T),Q=S(D,T,L,I);0===i&&Q>0?Q-=2*Math.PI:1===i&&Q<0&&(Q+=2*Math.PI);let k=(+(Math.abs(Q)/(l/4)).toFixed(0)||1)*a;Q/=k;let E=[];const F=1.5707963267948966,$=.551785;let B=Q===F?$:Q===-F?-$:4/3*Math.tan(Q/4),q=Q?Math.cos(Q):1,O=Q?Math.sin(Q):0;const N=(e,t,a,l,n)=>{let s=e!=t?Math.cos(e):l,h=e!=t?Math.sin(e):n,r=Math.cos(e+t),i=Math.sin(e+t);return[{x:s-h*a,y:h+s*a},{x:r+i*a,y:i-r*a},{x:r,y:i}]};for(let e=0;e<k;e++){let e={type:"C",values:[]};N(z,Q,B,q,O).forEach((t=>{let a=t.x*n,l=t.y*s;e.values.push(c*a-x*l+P,x*a+c*l+w)})),E.push(e),z+=Q}return E}function De(e,t=7.5,a=!0,l=!1){const n=1.333;let s,h,r,i,u,y,o,x,c,p,f,g,v,M,m,d,b,C,A,P,w=[],D=e.length,{type:T,p0:L,cp1:I,cp2:Q=null,p:k,values:F}=e[0],$=[{type:"M",values:[L.x,L.y]},...e],B=he($),q=e.length-1,O=e.length>2?Math.ceil(e.length/2)-1:1,N=!1,j=1e4,R=1e4,V=1e4;if(!l&&1===D&&"C"===T){let a=J([L,I,Q,k]);if(P=a.area,a.flat)return console.log("is flat cubic!"),console.log(a,"thresh"),w=[{type:"L",values:[k.x,k.y]}],w;let l=S(L,I,k,Q,!1);return w=[e[0]],l&&(f=re([L,l,k],B,P,t).areaDiff,f<t&&(w=[{type:"Q",values:[l.x,l.y,k.x,k.y]}])),w}if(D>1&&("Q"===T&&(e.forEach(((t,a)=>{let l=ve(t.p0,t.values),n={x:l.values[0],y:l.values[1]},s={x:l.values[2],y:l.values[3]};e[a].type="C",e[a].cp1=n,e[a].cp2=s,e[a].values=[n.x,n.y,s.x,s.y,t.p.x,t.p.y]})),T="C"),s=e[1].p0,h=e[1].cp1,r="C"===T?e[1].cp2:null,i=e[1].p,o=e[q].p,u=e[q].cp1,y="C"===T?e[q].cp2:e[q].cp1,P=oe([L,I,r,o]),!l)){J(e.map((e=>[e.p0,e.cp1,e.cp2,e.p])).flat())}if(D>2){let{com:a,isArc:l,area:u}=ce(L,I,y,o);if(x=ue(B,u),l&&x<.75*t)return w=[a],w;let C=e[O].p,A="C"===T?e[O].cp2:e[O].cp1,D=S(C,A,L,I,!1);if(D){c=D,p=S(C,A,o,y,!1),M=E([L,c],n),m=E([o,p],n),f=re([L,M,m,o],B,P,t),N=f.accurate,j=f.areaDiff,x=j}if(!N){v=E("C"===T?[s,h,r,i]:[s,h,i],.5,!0,!0);let e="C"===T?v.cpts[2]:v.cpts[0];d=S(v,e,I,L,!1),b=S(v,e,y,o,!1),d=E([L,d],n),b=E([o,b],n),g=re([L,d,b,o],B,P,t),N=g.accurate,R=g.areaDiff}c=j<R?M:d,p=j<R?m:b,x=j<R?j:R}else if(2===D){let a,l,s;if(r=e[0].cp2,y=e[1].cp2,a=S(L,I,y,o,!1),a&&(l=S(k,r,L,a,!1),s=S(k,u,o,a,!1),M=E([L,l],n),m=E([o,s],n),f=re([L,M,m,o],B,P,t),N=f.accurate,j=f.areaDiff),!N){let e=z(L,h),a=z(i,y),l=e+a,n=l/a;d=E([L,h],l/e),b=E([i,y],n),g=re([L,d,b,o],B,P,t),N=g.accurate,R=g.areaDiff}if(!N){I=e[0].cp1,Q=e[0].cp2,k=e[0].p,v=E([L,I,Q,k],.5,!0,!0);let a="C"===T?v.cpts[2]:v.cpts[0];C=S(v,a,I,L,!1),A=S(v,a,y,o,!1),C=E([L,C],n),A=E([o,A],n),g=re([L,C,A,o],B,P,t),N=g.accurate,V=g.areaDiff,V<t&&V<R&&(d=C,b=A,R=V)}c=j<R?M:d,p=j<R?m:b,x=j<R?j:R}return c&&p?(x<t?w.push({type:"C",values:[c.x,c.y,p.x,p.y,o.x,o.y]}):w=e,w.length,w):[...e]}function Te(e,t=.1){let a=e[0].values.slice(-2).map((e=>+e.toFixed(8))),l=e[0].p0,n=l,s=[];for(let t=1,h=e.length;t<h;t++){let h=e[t-1];if(a=h.values.slice(-2).map((e=>+e.toFixed(8))),n={x:a[0],y:a[1]},n.x===l.x&&n.y===l.y){console.log("zero length",h),l=n;continue}let r=e[t].values.slice(-2),i={x:r[0],y:r[1]};if(J([l,n,i]).flat){let e=I(l,n,!0),t=I(n,i,!0);if(Math.abs(e-t)<Math.PI/4)continue}l=n,s.push(h)}return s.push(e[e.length-1]),s}function Le(e=[],t=!0){let a=H(e=JSON.parse(JSON.stringify(e))),l=[],n=[];return a.forEach((e=>{let t,a=he(e),s=K(F(e)),{left:h,right:r,top:i,bottom:u,width:y,height:o}=s,x=e[0].values[0],c=e[0].values[1],p={x:e[0].values[0],y:e[0].values[1]},f={x:e[0].values[0],y:e[0].values[1]};e[0].p0=p,e[0].p=p,e[0].lineto=!1,e[0].corner=!1,e[0].extreme=!1,e[0].directionChange=!1,e[0].closePath=!1;let g=[e[0]],v=0,M=e.length;for(let a=2;M&&a<=M;a++){let l=e[a-1],{type:n,values:s}=l,M=s.slice(-2),m=[f],d=!1;l.lineto=!1,l.corner=!1,l.extreme=!1,l.directionChange=!1,l.closePath=!1;let b,C,A,P,w,D,T,L=.05;if(t=M.length?{x:M[0],y:M[1]}:p,"M"===n?(p=t,f=t):"z"===n.toLowerCase()&&(t=p),l.p0=f,l.p=t,"L"===n&&(l.lineto=!0),"Z"===n&&(l.closePath=!0,p.x!==x&&p.y!==c&&(l.lineto=!0)),"Q"!==n&&"C"!==n||(b={x:s[0],y:s[1]},C="C"===n?{x:s[2],y:s[3]}:null,l.cp1=b,C&&(l.cp2=C)),s.length>2){"Q"!==n&&"C"!==n||m.push(b),"C"===n&&m.push(C),m.push(t),d=J(m).flat,l.flat=d,d&&(l.extreme=!1)}d||"L"===n||t.x!==h&&t.y!==i&&t.x!==r&&t.y!==u||(l.extreme=!0);let S=(y+o)/2;l.dimA=S;let z=e[a]?e[a]:null,k=z?z.values.slice(-2):null;D=z?z.type:null,z&&(w=z?{x:k[0],y:k[1]}:null,"Q"!==z.type&&"C"!==z.type||(A={x:z.values[0],y:z.values[1]},P="C"===z.type?{x:z.values[2],y:z.values[3]}:null)),T=oe(m);let E=v<0&&T>0||v>0&&T<0;if(v=T,E&&(l.directionChange=!0),("Q"===n||"C"===n)&&("Q"===n&&"Q"===D||"C"===n&&"C"===D)){let e=m.slice(1),a=J("C"===n?[t,A,P,w]:[t,A,w],(Math.abs(w.x-f.x)+Math.abs(w.y-f.y))/2*.1).flat;if((!d||!a)&&(!!l.extreme||q(0,e,L)))l.extreme=!0;else{let e=C?[C,t]:[b,t],a=[t,A],n=I(...e,!0),s=I(...a,!0),h=180*Math.abs(n-s)/Math.PI,r=Q(...e),i=Q(...a);h>10&&r&&i&&(l.corner=!0)}}g.push(l),f=t}let m=(y+o)/2;l.push({pathData:g,bb:s,area:a,dimA:m}),n.length&&console.log(n)})),l}function Ie(e,t,a){return e.forEach(((e,l)=>{let{type:n,values:s}=e;switch(n.toLowerCase()){case"a":e.values=[s[0]*t,s[1]*a,s[2],s[3],s[4],s[5]*t,s[6]*a];break;case"h":e.values=[s[0]*t];break;case"v":e.values=[s[0]*a];break;default:if(s.length)for(let l=0;l<s.length;l+=2)e.values[l]*=t,e.values[l+1]*=a}})),e}function Se(e,t=3,a=!0,l=!1,n=!0,s=!1,h=!1){he(e);let r=te(e),i=(r.width+r.height)/2,u=i<10?100/i:1;1!=u&&(e=Ie(e,u,u));let y=!0;y=!1;let o=!1,x=!0,c=Z(Le(e=ne(e,y,o,x,h)),h),p=[];for(let e=0,n=c.length;n&&e<n;e++){let n,s=c[e],{chunks:h,dimA:r,area:i}=s,u=h.length;for(let e=0;e<u;e++){let s=h[e],r=s[0].type;if(l||1!==s.length||"C"!==r)if(s.length<2)p.push(...s);else if("L"===r&&s.length>1)n=Te(s),p.push(...n);else if(s.length>1&&("C"===r||"Q"===r)){if(s.length)if(s[0].directionChange,a&&s.length>4){let e=Math.ceil((s.length-1)/2),n=s.slice(0,e),h=s.slice(e),r=De(n,t,a,l),i=De(h,t,a,l);p.push(...r,...i)}else n=De(s,t,a,l),p.push(...n)}else p.push(...s);else n=De(s),p.push(...n)}}return n&&(p=xe(p,.5*t),p=pe(p),console.log("arcs",p)),1!=u&&(p=Ie(p,1/u,1/u)),o=!0,x=!1,y=!1,p=ne(p,y,o,x,h=!1),console.log("pathDataSimple post",p),p}function ze(e,{normalize:t=null,optimize:a=1,toAbsolute:l=!0,toRelative:h=!1,quadraticToCubic:r=!1,lineToCubic:i=!1,toLonghands:u=!0,toShorthands:y=!1,arcToCubic:o=!1,arcParam:x=!1,arcAccuracy:c=1,optimizeOrder:p=!1,reorderSub:f=!1,simplify:g=!1,tolerance:v=7.5,keepDetails:M=!0,forceCubic:m=!1,cubicToArc:d=!0,multipass:b=!1,cubicToQuadratic:C=!1,cubicToQuadraticPrecision:A=.1,decimals:P=-1,cubicToArcs:w=!1}={}){return!0===t&&(l=!0,u=!0,o=!0,r=!0,y=!1),e=JSON.parse(JSON.stringify(e)),l&&(e=de(e)),u&&(e=be(e,-1,!1)),g&&(he(e),e=Se(e,v,M,m,d,b)),e=n(e),w&&!o&&(e=pathDataCubicToArc(e)),r&&(e=ge(e)),C&&(e=Ae(e,A)),o&&(e=fe(e)),-1!==P&&(e=s(e,P)),y&&(e=Ce(e)),h&&(e=me(e)),-1!==P&&(e=s(e,P)),e}function Qe(e="",t={}){!0===(t={normalize:!1,optimize:1,toAbsolute:!0,toRelative:!1,quadraticToCubic:!1,cubicToQuadratic:!1,cubicToQuadraticPrecision:.1,lineToCubic:!1,toLonghands:!0,toShorthands:!1,arcToCubic:!1,arcParam:!1,arcAccuracy:1,decimals:-1,minify:1,...t}).normalize&&(t.toAbsolute=!0,t.toLonghands=!0,t.arcToCubic=!0,t.quadraticToCubic=!0,t.toShorthands=!1);let l=a(e),{pathData:n,hasRelatives:s,hasArcs:h,hasQuadratics:r,hasShorthands:i}=l;t.toAbsolute&&(t.toAbsolute=s),t.toLonghands&&(t.toLonghands=i),t.quadraticToCubic&&(t.quadraticToCubic=r),t.arcToCubic&&(t.arcToCubic=h),this.pathDataO=n,this.hasRelatives=s,this.hasArcs=h,this.hasQuadratics=r,this.hasShorthands=i;let u=ze(n,t);this.pathDataN=u,this.pathData=[],this.d=e}Qe.prototype.convert=function(e){let t=JSON.parse(JSON.stringify(this.pathDataN));return t=ze(t,e),this.pathData=t,this.d=l(this.pathData,e.optimize),this},Qe.prototype.toD=function(e=1){let t=this.pathData.length?this.pathData:this.pathDataN;return this.d=l(t,e),this.d},Qe.prototype.toString=function(e=1){let t=this.pathData.length?this.pathData:this.pathDataN;return this.d=l(t,e),this.d},e.PI=L,e.Path=Qe,e.abs=h,e.acos=r,e.addClosePathLineto=le,e.addExtemesToCommand=G,e.addExtremePoints=function(e){let t=[e[0]],a={x:e[0].values[0],y:e[0].values[1]},l={x:e[0].values[0],y:e[0].values[1]},n=e.length;for(let s=1;n&&s<n;s++){let n=e[s],{type:h,values:r}=n,i=r.slice(-2);i[0],i[1],"C"!==h&&"Q"!==h?t.push(n):"C"!==h&&"Q"!==h||t.push(...G(a,r)),a={x:i[0],y:i[1]},"z"===h.toLowerCase()?a=l:"M"===h&&(l={x:i[0],y:i[1]})}return t},e.analyzePathData=Le,e.arcToBezier=we,e.asin=i,e.atan=u,e.atan2=y,e.bezierhasExtreme=q,e.ceil=o,e.checkBBoxIntersections=X,e.checkLineIntersection=S,e.cleanUpPathData=ne,e.combineArcs=pe,e.commandIsFlat=J,e.commandIsFlat0=function(e,t=.025){let a=e.map((e=>e.x)),l=e.map((e=>e.y)),n=Math.min(...a),s=Math.max(...a),h=Math.min(...l),r=s-n,i=Math.max(...l)-h;if(e.length<3||0===r||0===i)return{area:0,flat:!0,thresh:1e-4,ratio:0};let u=.5*(r+i)*.5,y=0;for(let t=0;t<e.length;t++){y+=e[t].x*e[t===e.length-1?0:t+1].y*.5-e[t===e.length-1?0:t+1].x*e[t].y*.5}y=+Math.abs(y).toFixed(9);let o=y/u;return{area:y,flat:0===y||o<.15,thresh:u,ratio:o}},e.convertArrayPathData=function(e){let t=[];return e.forEach((e=>{let a=e.shift();t.push({type:a,values:e})})),t},e.convertPathData=ze,e.cos=c,e.cubicBezierExtremeT=j,e.cubicToArc=ce,e.cubicToQuad=Pe,e.detectAccuracy=n,e.exp=p,e.floor=f,e.getAngle=I,e.getArcExtemes=N,e.getBezierArea=ye,e.getBezierAreaAccuracy=re,e.getBezierExtremeT=O,e.getComBBTolerance=function(e,t,a=.5){let l=Math.min(e.x,t.x),n=Math.max(e.x,t.x),s=Math.min(e.y,t.y);return.5*(n-l+(Math.max(e.y,t.y)-s))*a},e.getComThresh=function(e,t=.01){let a=e.map((e=>e.x)),l=e.map((e=>e.y)),n=Math.min(...a),s=Math.max(...a),h=Math.min(...l);return(s-n+(Math.max(...l)-h))/2*t},e.getDistAv=function(e,t){return(Math.abs(e.x-t.x)+Math.abs(e.y-t.y))/2},e.getDistance=z,e.getEllipseArea=ie,e.getPathArea=he,e.getPathDataBBox=te,e.getPathDataBBox_sloppy=Y,e.getPathDataPlusChunks=Z,e.getPathDataPoly=ee,e.getPathDataVertices=F,e.getPointOnEllipse=B,e.getPolyBBox=K,e.getPolygonArea=oe,e.getRelativeAreaDiff=ue,e.getSquareDistance=Q,e.getSubPathBBoxes=W,e.getTangentAngle=function(e,t,a){let l=-e*w(a),n=t*c(a);return y(n,l)},e.interpolate=k,e.intersectLines=function(e,t,a,l){if(Math.max(e.x,t.x)<Math.min(a.x,l.x)||Math.min(e.x,t.x)>Math.max(a.x,l.x)||Math.max(e.y,t.y)<Math.min(a.y,l.y)||Math.min(e.y,t.y)>Math.max(a.y,l.y))return!1;let n=(e.x-t.x)*(a.y-l.y)-(e.y-t.y)*(a.x-l.x);if(0==n)return!1;let s=e.y-a.y,h=e.x-a.x,r=(l.x-a.x)*s-(l.y-a.y)*h,i=(t.x-e.x)*s-(t.y-e.y)*h;s=r/n,h=i/n;let u=e.x+s*(t.x-e.x),y=e.y+s*(t.y-e.y),o=+u.toFixed(2),x=+y.toFixed(2);return o<+Math.min(e.x,t.x).toFixed(2)||o>+Math.max(e.x,t.x).toFixed(2)||o<+Math.min(a.x,l.x).toFixed(2)||o>+Math.max(a.x,l.x).toFixed(2)||x<+Math.min(e.y,t.y).toFixed(2)||x>+Math.max(e.y,t.y).toFixed(2)||x<+Math.min(a.y,l.y).toFixed(2)||x>+Math.max(a.y,l.y).toFixed(2)?!!((e,t,a,l,n,s,h=.001)=>Math.abs((l-t)/(a-e)*(n-e)+t-s)<h&&n>=e&&n<=a)(a.x,a.y,l.x,l.y,t.x,t.y,.1)&&{x:t.x,y:t.y}:{x:u,y:y,t:h}},e.lineLength=function(e,t){return D((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},e.log=g,e.max=v,e.min=M,e.optimizeStartingPoints=se,e.parse=a,e.pathDataArcsToCubics=fe,e.pathDataQuadraticToCubic=ge,e.pathDataToAbsolute=de,e.pathDataToAbsoluteOrRelative=Me,e.pathDataToD=l,e.pathDataToLonghands=be,e.pathDataToQuadratic=Ae,e.pathDataToRelative=me,e.pathDataToShorthands=Ce,e.pathDataToVerbose=function(e){let t=JSON.parse(JSON.stringify(e));e=be(de(e));let a=[],l=e.length,n="z"===e[l-1].type.toLowerCase();return e.forEach(((l,s)=>{let{type:h,values:r}=l,i=t[s],u=i.type,y=i.values,o=u.toLowerCase(),x=r.length,c=u===u.toLowerCase(),p=!!e[s-1]&&e[s-1],f=p?p.values:[],g=f.length,v={x:f[g-2],y:f[g-1]},M={type:u,values:y,valuesAbsolute:r,pFinal:x?{x:r[x-2],y:r[x-1]}:!(s!==e.length-1||!n)&&e[0].values,isRelative:c};switch(g&&(M.pPrev=v),o){case"q":M.cp1={x:r[x-4],y:r[x-3]};break;case"c":M.cp1={x:r[x-6],y:r[x-5]},M.cp2={x:r[x-4],y:r[x-3]};break;case"a":let e=svgArcToCenterParam(v.x,v.y,r[0],r[1],r[2],r[3],r[4],r[5],r[6]);M.rx=e.rx,M.ry=e.ry,M.xAxisRotation=r[2],M.largeArcFlag=r[3],M.sweepFlag=r[4],M.startAngle=e.startAngle,M.endAngle=e.endAngle,M.deltaAngle=e.deltaAngle}a.push(M)})),a},e.pointAtT=E,e.pow=d,e.quadratic2Cubic=ve,e.quadraticBezierExtremeT=R,e.random=C,e.reducepts=function(e,t=48){if(!Array.isArray(e)||e.length<=t)return e;let a=e.length,l=a/t,n=[];for(let a=0;a<t;a++)n.push(e[Math.floor(a*l)]);let s=n.length;return n[s-1]!==e[a-1]&&(n[s-1]=e[a-1]),n},e.reorderPathData=function(e,t=["x","y"]){let a=H(e);if(1===a.length)return e;let l=[];var n;a.forEach((function(e,t){let a=K(F(e)),{x:n,y:s,width:h,height:r}=a;l.push({x:n,y:s,width:h,height:r,index:t})})),l.sort((n=t,function(e,t){return n.map((function(a){var l=1;return"-"===a[0]&&(l=-1,a=a.substring(1)),e[a]>t[a]?l:e[a]<t[a]?-l:0})).reduce((function(e,t){return e||t}),0)}));let s=[];return l.forEach((function(e,t){let l=e.index;s.push(...a[l])})),console.log("subPathsSorted",s),s},e.replaceCubicsByArcs=xe,e.revertPathDataToArray=function(e){let t=[];return e.forEach((e=>{t.push([e.type,e.values].flat())})),t},e.rotatePoint=function(e,t,a,l=0,n=!1){return l?(l=n?l/180*Math.PI:l,{x:t+(e.x-t)*Math.cos(l)-(e.y-a)*Math.sin(l),y:a+(e.x-t)*Math.sin(l)+(e.y-a)*Math.cos(l)}):e},e.round=A,e.roundPathData=s,e.shiftSvgStartingPoint=ae,e.simplifyPathData=Se,e.sin=w,e.splitCommand=U,e.splitCommandAtTValues=_,e.splitSubpaths=H,e.sqrt=D,e.svgArcToCenterParam=$,e.tan=T,e.toNonParametricAngle=function(e,t,a){if(t===a||e%L*.5==0)return e;let l=u(T(e)*(a/t));return c(e)<0?l+L:l},e.toParametricAngle=function(e,t,a){if(t===a||e%L*.5==0)return e;let l=u(T(e)*(t/a));return l=c(e)<0?l+L:l,l}}));
